{"version":3,"sources":["logo.png","App.js","reportWebVitals.js","index.js"],"names":["baseURL","URL","window","location","axios","defaults","hostname","App","useState","email","setEmail","senha","setSenha","loading","setLoading","auth","setAuth","setToken","setParams","user","setUser","homes","setHomes","selectedHome","setHome","handleSubmit","e","a","alert","post","response","data","get","_id","console","log","token","message","handleAceito","params","URLSearchParams","search","homeId","homeAccount","grant_type","replace","code","apply","useEffect","className","src","logo","width","alt","onChange","target","value","length","map","item","nome","href","onClick","name","type","required","placeholder","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qPAAe,MAA0B,iC,+BCKnCA,EAAW,IAAIC,IAAIC,OAAOC,UAChCC,IAAMC,SAASL,QAA8B,cAAnBA,EAAQM,SAAR,8BAA6D,6DA4LxEC,MA1Lf,WAEI,MAA0BC,mBAAS,IAAnC,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAA0BF,mBAAS,IAAnC,mBAAOG,EAAP,KAAcC,EAAd,KAEA,EAA8BJ,oBAAS,GAAvC,mBAAOK,EAAP,KAAgBC,EAAhB,KAEA,EAAwBN,oBAAS,GAAjC,mBAAOO,EAAP,KAAaC,EAAb,KACA,EAA0BR,mBAAS,MAAnC,mBAAcS,GAAd,WACA,EAA4BT,mBAAS,MAArC,mBAAeU,GAAf,WACA,EAAwBV,mBAAS,IAAjC,mBAAOW,EAAP,KAAaC,EAAb,KACA,EAA0BZ,mBAAS,IAAnC,mBAAOa,EAAP,KAAcC,EAAd,KACA,EAAgCd,mBAAS,MAAzC,mBAAOe,EAAP,KAAqBC,EAArB,KAUMC,EAAY,uCAAG,WAAOC,GAAP,mBAAAC,EAAA,kEAGC,KAAVlB,EAHS,uBAGOmB,MAAM,yBAHb,6BAIC,KAAVjB,EAJS,uBAIOiB,MAAM,wBAJb,iCAMbd,GAAW,GANE,UAOUV,IAAMyB,KAAK,aAAc,CAAEpB,QAAOE,UAP5C,eAOPmB,EAPO,OAQLC,EAASD,EAASC,KAAlBA,KARK,UAUO3B,IAAM4B,IAAN,qBAAwBD,EAAKZ,KAAKc,MAVzC,QAUPZ,EAVO,OAWba,QAAQC,IAAId,EAAMU,KAAKA,MACvBT,EAAS,YAAID,EAAMU,KAAKA,OACxBd,EAASc,EAAKK,OACdhB,EAAQW,EAAKZ,MAEbH,GAAQ,GACRF,GAAW,GAjBE,kDAoBbA,GAAW,GACP,KAAMgB,SACNF,MAAM,KAAME,SAASC,KAAKM,SAE1BT,MAAM,KAAMS,SAEhBH,QAAQC,IAAI,KAAML,UA1BL,0DAAH,sDAgDZQ,EAAY,uCAAG,gCAAAX,EAAA,kEAMkB,cAFzBY,EAAS,IAAIC,gBAAgBtC,OAAOC,SAASsC,SAEzCT,IAAI,aAND,uBAOTJ,MAAM,8BAPG,6BAWTL,EAXS,uBAYTK,MAAM,uBAZG,iCAgBbd,GAAW,GAEXK,EAAKuB,OAASnB,EAlBD,UAmBUnB,IAAMyB,KAAK,wBAAyB,CAAEc,YAAYxB,EAAMyB,WAAW,kBAnB7E,QAmBPd,EAnBO,OAoBLC,EAASD,EAATC,KACR7B,OAAOC,SAAS0C,QAAhB,UAA2BN,EAAOP,IAAI,gBAAtC,iBAA8DD,EAAKe,KAAnE,kBAAiFP,EAAOP,IAAI,WArB/E,kDAwBblB,GAAW,GACR,KAAMgB,UACLF,MAAMmB,MAAM,KAAMjB,SAASO,SAC3BH,QAAQC,IAAI,KAAML,YAElBF,MAAM,KAAMS,SACZH,QAAQC,IAAR,OA9BS,0DAAH,qDA0ClB,OALAa,qBAAU,cAGP,IAGC,sBAAKC,UAAU,OAAf,UACKpC,GACG,qBAAKoC,UAAU,UAAf,SACI,qBAAKA,UAAU,4BAAf,SACI,qBAAKA,UAAU,aAAf,SACI,sBAAKA,UAAU,SAAf,UACI,4CACA,qBAAKA,UAAU,SACf,qBAAKA,UAAU,SACf,qBAAKA,UAAU,kBAMlClC,GACG,qCACI,yBAAQkC,UAAU,cAAlB,UACI,qBAAKC,IAAKC,EAAMC,MAAM,KAAKH,UAAU,YAAYI,IAAI,SACrD,oBAAGJ,UAAU,OAAb,iCAAwC,uBAAxC,mBAEJ,sBAAKA,UAAU,YAAf,UACI,sBAAKA,UAAU,aAAf,UACI,0EACA,yBAAQA,UAAU,eAAeK,SA5EhC,SAAC5B,GACtBQ,QAAQC,IAAIT,EAAE6B,OAAOC,OACrBhC,EAAQE,EAAE6B,OAAOC,QA0EG,UACI,wBAAQA,MAAM,GAAd,oCACkB,IAAjBnC,EAAMoC,QAAgBpC,EAAMqC,KAAK,SAAAC,GAC9B,OAAO,wBAAuBH,MAAOG,EAAK1B,IAAnC,SAAyC0B,EAAKC,MAAjCD,EAAK1B,cAIrC,2OAIA,qBAAKgB,UAAU,kBAAf,SACI,2CAAa,mBAAGM,OAAO,SAASM,KAAK,8BAAxB,mDAAb,KAA2G,uBAA3G,4CAC0C,mBAAGN,OAAO,SAASM,KAAK,gCAAxB,yBAD1C,SAIJ,sBAAKZ,UAAU,qDAAf,UACI,wBAAQA,UAAU,gBAAgBa,QAxFpC,WAblB1C,EAAQ,MACRJ,GAAQ,GACRE,EAAU,MACVD,EAAS,MACTP,EAAS,IACTE,EAAS,KAgGW,sBACA,wBAAQqC,UAAU,kBAAkBa,QAASxB,EAA7C,0CAMdvB,GACE,qCACI,yBAAQkC,UAAU,0BAAlB,UACI,qBAAKC,IAAKC,EAAMC,MAAM,KAAKH,UAAU,YAAYI,IAAI,SACrD,oBAAGJ,UAAU,OAAb,2BAAkC,uBAAlC,uBAEJ,sBAAKA,UAAU,YAAf,UACI,sBAAKA,UAAU,aAAf,UACI,uBAAOA,UAAU,QAAjB,gCACA,uBAAOA,UAAU,eAAeO,MAAO/C,EAAO6C,SAxJlD,SAAC5B,GACjBhB,EAASgB,EAAE6B,OAAOC,QAuJuEO,KAAK,QAAQC,KAAK,QAAQC,UAAU,EAAMC,YAAY,cAE/H,sBAAKjB,UAAU,aAAf,UACI,uBAAOA,UAAU,QAAjB,mBACA,uBAAOA,UAAU,eAAeO,MAAO7C,EAAO2C,SAhKlD,SAAC5B,GACjBd,EAASc,EAAE6B,OAAOC,QA+JuEQ,KAAK,WAAWD,KAAK,QAAQE,UAAU,EAAMC,YAAY,kBAElI,qBAAKjB,UAAU,aAAf,SACI,wBAAQA,UAAU,gBAAgBa,QAASrC,EAA3C,gCC7Kb0C,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCDdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1Bb,M","file":"static/js/main.1d0e6b5b.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.fbeef7d5.png\";","import React, { useEffect, useState } from 'react';\nimport logo from './logo.png';\nimport './App.css';\nimport axios from 'axios';\n\nconst baseURL  = new URL(window.location)\naxios.defaults.baseURL =  baseURL.hostname===\"localhost\"?`http://192.168.0.7:3000/dev`:\"https://mkcr9bfn2i.execute-api.sa-east-1.amazonaws.com/dev\"\n\nfunction App() {\n\n    const [email, setEmail] = useState('')\n    const [senha, setSenha] = useState('')\n\n    const [loading, setLoading] = useState(false)\n\n    const [auth, setAuth] = useState(false)\n    const [token, setToken] = useState(null)\n    const [params, setParams] = useState(null)\n    const [user, setUser] = useState({})\n    const [homes, setHomes] = useState([])\n    const [selectedHome, setHome] = useState(null)\n\n    const handleSenha = (e) => {\n        setSenha(e.target.value)\n    }\n\n    const handleEmail = (e) => {\n        setEmail(e.target.value)\n    }\n\n    const handleSubmit = async (e) => {\n        try {\n\n            if (email === '') { alert('Email obritgatório'); return; }\n            if (senha === '') { alert('Senha obrigatória'); return; }\n            \n            setLoading(true)\n            const response = await axios.post('auth/login', { email, senha })\n            const { data } = response.data\n             \n            const homes = await axios.get(`home?owner=${data.user._id}`)\n            console.log(homes.data.data)\n            setHomes([...homes.data.data])\n            setToken(data.token)\n            setUser(data.user)\n\n            setAuth(true)\n            setLoading(false)\n\n        } catch (error) {\n            setLoading(false)\n            if (error.response) {\n                alert(error.response.data.message)\n            } else {\n                alert(error.message)\n            }\n            console.log(error.response)\n        }\n    }\n\n    const resetParams = () => {\n        setUser(null)\n        setAuth(false)\n        setParams(null)\n        setToken(null)\n        setEmail('')\n        setSenha('')\n    }\n\n    const handleSelectHome = (e)=>{\n        console.log(e.target.value)\n        setHome(e.target.value)\n    }\n\n    const handleCancela = () => {\n        resetParams()\n    }\n\n    const handleAceito = async () => {\n\n        try {\n\n            const params = new URLSearchParams(window.location.search)\n \n            if(params.get('client_id') !== 'bluedevx'){\n                alert('Integração incorreta')\n                return\n            }\n\n            if(!selectedHome){\n                alert('Selecione uma casa!')\n                return\n            }\n\n            setLoading(true)\n\n            user.homeId = selectedHome\n            const response = await axios.post('auth/google-assistant', { homeAccount:user, grant_type:'generate_code' })\n            const { data } = response\n            window.location.replace(`${params.get('redirect_uri')}?code=${data.code}&state=${params.get('state')}`)\n\n        } catch (error) {\n            setLoading(false)\n            if(error.response){\n                alert.apply(error.response.message)\n                console.log(error.response)\n            }else{\n                alert(error.message)\n                console.log(error)\n            }\n            \n            \n        }\n    }\n\n    useEffect(() => {\n       \n        //return () => resetParams()\n    }, [])\n\n    return (\n        <div className=\"form\">\n            {loading &&\n                <div className=\"loading\">\n                    <div className=\"loading-rotulo text-white\">\n                        <div className=\"load-wrapp\">\n                            <div className=\"load-2\">\n                                <p>Processando</p>\n                                <div className=\"line\"></div>\n                                <div className=\"line\"></div>\n                                <div className=\"line\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            }\n            {auth &&\n                <>\n                    <header className=\"form-header\">\n                        <img src={logo} width=\"70\" className=\"form-logo\" alt=\"logo\" />\n                        <p className=\"pt-3\">Conectando Bluedevx <br />com Google</p>\n                    </header>\n                    <div className=\"form-body\">\n                        <div className=\"form-group\">\n                            <label>Escolha a casa que deve ser vinculada</label>\n                            <select className=\"form-control\" onChange={handleSelectHome}>\n                                <option value=\"\">==Selecione na lista==</option>\n                                {homes.length !== 0 && homes.map (item=>{\n                                    return <option key={item._id} value={item._id}>{item.nome}</option>\n                                })}\n                            </select>\n                        </div>\n                        <p>\n                            O Google solicita acesso à sua conta na Bluedevx e ao mapa de dispositivos que você possui.\n                            Assim você terá a possibilidade de acessá-los através dos comandos de voz e outros recursos.\n                        </p>\n                        <div className=\"my-4 text-small\">\n                            <p>Revise as <a target=\"_blank\" href=\"http://policies.google.com/\">políticas de privacidade do Google</a>. <br />\n                                Se você deseja desvincular sua conta, <a target=\"_blank\" href=\"https://myaccount.google.com/\">clique aqui</a>.</p>\n\n                        </div>\n                        <div className=\"form-group d-flex flex-row justify-content-between\">\n                            <button className=\"btn btn-light\" onClick={handleCancela}>Cancelar</button>\n                            <button className=\"btn btn-success\" onClick={handleAceito} >Aceitar e conectar</button>\n                        </div>\n                    </div>\n                </>\n            }\n\n            {!auth &&\n                <>\n                    <header className=\"form-header text-center\">\n                        <img src={logo} width=\"70\" className=\"form-logo\" alt=\"logo\" />\n                        <p className=\"p-10\">Entre com sua <br />conta Bluedevx</p>\n                    </header>\n                    <div className=\"form-body\">\n                        <div className=\"form-group\">\n                            <label className=\"label\">E-mail de Cadastro</label>\n                            <input className=\"form-control\" value={email} onChange={handleEmail} name=\"email\" type=\"email\" required={true} placeholder=\"E-mail\"></input>\n                        </div>\n                        <div className=\"form-group\">\n                            <label className=\"label\">Senha</label>\n                            <input className=\"form-control\" value={senha} onChange={handleSenha} type=\"password\" name=\"senha\" required={true} placeholder=\"**********\"></input>\n                        </div>\n                        <div className=\"form-group\">\n                            <button className=\"btn btn-theme\" onClick={handleSubmit} >Entrar</button>\n                        </div>\n                    </div>\n                </>\n            }\n        </div>\n    );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}